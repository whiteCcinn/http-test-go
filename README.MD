# HTTP Load Testing Tool

This is a simple HTTP load testing tool written in Go. It supports features such as measuring **TPS (Transactions Per Second)**, **QPS (Queries Per Second)**, response time percentiles (**P50**, **P95**, **P99**), and provides detailed statistics and trends via ASCII graphs.

The tool can also be configured to support **Keep-Alive** for some requests, and it allows you to provide a **JSON file** containing body data for requests.

---

## Features

- **TPS (Transactions Per Second)**: Measures the successful requests handled per second.
- **QPS (Queries Per Second)**: Measures the total number of requests per second, regardless of whether they succeed or fail.
- **Response Time Percentiles**: Measures the 50th (P50), 95th (P95), and 99th (P99) percentiles of the request response time.
- **Real-Time Statistics**: Displays metrics such as TPS, QPS, P50, P95, and P99.
- **ASCII Graphs**: Real-time trends of TPS, QPS, and response times.
- **Keep-Alive Support**: Ability to specify the ratio of requests using HTTP Keep-Alive.
- **Request Body from JSON File**: Supports loading request bodies from a JSON file for multiple requests.

---

## Installation

### Prerequisites

- **Go** 1.18 or higher

### Steps to install:

1. Clone the repository:
```bash
   git clone https://github.com/your-username/http-bench.git
   cd http-bench
```
2. Build the executable:
```
go build -o http_bench
```
3. Run the tool with the desired parameters.

## Usage

### Command-Line Arguments
- -url: The target URL (default is http://localhost:8080).
- -c: Number of concurrent requests (default is 10).
- -n: Total number of requests to send (default is 100).
- -keepalive_ratio: The percentage of requests to use Keep-Alive (default is 0.7).
- -X: The HTTP method to use (default is POST).
- -bodyfile: Path to a JSON file containing request bodies. The JSON file can be in two formats:
- ["body1", "body2", ...]
- [["url1", "body1"], ["url2", "body2"], ...]
- -interval: The number of requests after which to report statistics (default is 20).

## Example 1: Run a test with a single URL and body

```shell
./http_bench -url http://example.com -c 20 -n 500 -keepalive_ratio 0.5 -interval 50 -bodyfile requests.json
```

Where requests.json could be like:

```shell
[
    ["http://example.com/api1", "{\"name\": \"Alice\"}"],
    ["http://example.com/api2", "{\"name\": \"Bob\"}"]
]
```

## Example 2: Run a test with a default URL and multiple request bodies

```shell
./http_bench -c 20 -n 500 -keepalive_ratio 0.5 -interval 50 -bodyfile bodies.json
```

Where bodies.json could be like:

```shell
[
    "{\"name\": \"Alice\"}",
    "{\"name\": \"Bob\"}"
]
```

# Output

The tool will output statistics such as:

```
ğŸŒ  ç›®æ ‡ URL: http://example.com
ğŸ”„  å¹¶å‘æ•°: 20, æ€»è¯·æ±‚æ•°: 500
âš¡  Keep-Alive æ¯”ä¾‹: 0.50
ğŸ“¡  HTTP æ–¹æ³•: POST
======================================

ğŸ“¡  HTTP çŠ¶æ€ç ç»Ÿè®¡:
  - 200: 800 æ¬¡
  90% |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ                | (900/1000, 60 it/s) [15s:1s]+------------------+--------+
|      METRIC      | VALUE  |
+------------------+--------+
| Total Requests   |    900 |
| Success Requests |    900 |
| Failed Requests  |      0 |
| TPS              |  57.21 |
| QPS              |  57.21 |
| P50              | 145 ms |
| P95              | 308 ms |
| P99              | 505 ms |
+------------------+--------+

ğŸ“¡  HTTP çŠ¶æ€ç ç»Ÿè®¡:
  - 200: 900 æ¬¡
 100% |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| (1000/1000, 54 it/s)         
+------------------+--------+
|      METRIC      | VALUE  |
+------------------+--------+
| Total Requests   |   1000 |
| Success Requests |   1000 |
| Failed Requests  |      0 |
| TPS              |  54.10 |
| QPS              |  54.10 |
| P50              | 145 ms |
| P95              | 302 ms |
| P99              | 505 ms |
+------------------+--------+

ğŸ“¡  HTTP çŠ¶æ€ç ç»Ÿè®¡:
  - 200: 1000 æ¬¡

======================================
âœ…  æµ‹è¯•å®Œæˆï¼æœ€ç»ˆç»Ÿè®¡ç»“æœï¼š
+------------------+--------+
|      METRIC      | VALUE  |
+------------------+--------+
| Total Requests   |   1000 |
| Success Requests |   1000 |
| Failed Requests  |      0 |
| TPS              |  54.10 |
| QPS              |  54.10 |
| P50              | 145 ms |
| P95              | 302 ms |
| P99              | 505 ms |
+------------------+--------+

ğŸ“¡  HTTP çŠ¶æ€ç ç»Ÿè®¡:
  - 200: 1000 æ¬¡

ğŸ“ˆ  TPS å˜åŒ–è¶‹åŠ¿:
 57.21 â”¤       â•­â•®
 55.61 â”¤    â•­â”€â”€â•¯â”‚
 54.01 â”¤   â•­â•¯   â•°â”€
 52.41 â”¤  â•­â•¯
 50.81 â”¤ â•­â•¯
 49.21 â”¤ â”‚
 47.61 â”¤â•­â•¯
 46.01 â”¤â”‚
 44.41 â”¤â”‚
 42.81 â”¤â”‚
 41.21 â”¼â•¯

ğŸ“Š  QPS å˜åŒ–è¶‹åŠ¿:
 57.21 â”¤       â•­â•®
 55.61 â”¤    â•­â”€â”€â•¯â”‚
 54.01 â”¤   â•­â•¯   â•°â”€
 52.41 â”¤  â•­â•¯
 50.81 â”¤ â•­â•¯
 49.21 â”¤ â”‚
 47.61 â”¤â•­â•¯
 46.01 â”¤â”‚
 44.41 â”¤â”‚
 42.81 â”¤â”‚
 41.21 â”¼â•¯

ğŸ“‰  å“åº”æ—¶é—´è¶‹åŠ¿ (ms):
P50:
 181 â”¼â•®
 174 â”¤â”‚
 167 â”¤â”‚
 159 â”¤â”‚â•­â•®
 152 â”¤â•°â•¯â•°â”€â•®
 145 â”¤    â•°â”€â”€â”€â”€â”€
P95:
 516 â”¼â•®
 473 â”¤â”‚
 430 â”¤â•°â•®
 388 â”¤ â•°â•®
 345 â”¤  â•°â”€â”€â”€â•®
 302 â”¤      â•°â”€â”€â”€
P99:
 781 â”¼â•®
 726 â”¤â”‚
 671 â”¤â•°â•®
 615 â”¤ â•°â•®
 560 â”¤  â•°â•®
 505 â”¤   â•°â”€â”€â”€â”€â”€â”€
```

Output Explanation:
- Total Requests: Total number of requests made.
- Success Requests: Number of successful requests (HTTP status 2xx).
- Failed Requests: Number of failed requests (non-2xx status codes).
- TPS: Transactions Per Second (successful requests / total duration).
- QPS: Queries Per Second (total requests / total duration).
- P50: The 50th percentile of the response time.
- P95: The 95th percentile of the response time.
- P99: The 99th percentile of the response time.
- TPS & QPS Trends: ASCII graphs showing how TPS and QPS change over time.
- Response Time Trends: ASCII graphs showing how P50, P95, and P99 change over time.
